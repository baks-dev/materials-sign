executeFunc(function materialsSignPdf(){ChangeMaterialForm=document.forms.material_sign_report_form;if(typeof ChangeMaterialForm==="undefined"){return false}var object_category=document.getElementById(ChangeMaterialForm.name+"_category");if(object_category===null){return false}object_category.addEventListener("change",function(){changeObjectCategory(ChangeMaterialForm)},false);document.querySelectorAll(".js-datepicker").forEach(datepicker=>{MCDatepicker.create({el:"#"+datepicker.id,bodyType:"modal",autoClose:false,closeOndblclick:true,closeOnBlur:false,customOkBTN:"OK",customClearBTN:datapickerLang[$locale].customClearBTN,customCancelBTN:datapickerLang[$locale].customCancelBTN,firstWeekday:datapickerLang[$locale].firstWeekday,dateFormat:"DD.MM.YYYY",customWeekDays:datapickerLang[$locale].customWeekDays,customMonths:datapickerLang[$locale].customMonths})});var submit=document.getElementById(ChangeMaterialForm.name+"_material_sign_report");submit.addEventListener("click",event=>{event.preventDefault();let formSubmit=true;Array.from(ChangeMaterialForm.elements).forEach(input=>{let $errorFormHandler=false;if(input.validity.valid===false){formSubmit=false;let $placeholderText=false;setTimeout(closeProgress,1e3);$label=document.querySelector('label[for="'+input.id+'"]');$placeholderText=$label?$label.innerHTML:false;if(!$placeholderText){$placeholderInput=document.querySelector("#"+input.id+"");if($placeholderInput.tagName==="SELECT"){const firstOption=$placeholderInput.options[0];$placeholderText=firstOption.value===""?firstOption.textContent:false}else{$placeholder=$placeholderInput.getAttribute("placeholder");$placeholderText=$placeholder?$placeholder:false}}if(!$placeholderText){$placeholderText=input.id}if($placeholderText){$errorFormHandler='{ "type":"danger" , '+'"header":"Ошибка заполнения"   , '+'"message" : "'+$placeholderText+'"}';if($errorFormHandler!==false){createToast(JSON.parse($errorFormHandler))}}}});if(formSubmit){modaHidden();setTimeout(()=>{ChangeMaterialForm.submit()},300)}});return true});async function changeObjectCategory(forms){disabledElementsForm(forms);document.getElementById("material").classList.add("d-none");document.getElementById("offer").classList.add("d-none");document.getElementById("variation").classList.add("d-none");document.getElementById("modification").classList.add("d-none");const data=new FormData(forms);let formData=new FormData;formData.append(forms.name+"[category]",data.get(forms.name+"[category]"));await fetch(forms.action,{method:forms.method,cache:"no-cache",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"},redirect:"follow",referrerPolicy:"no-referrer",body:formData}).then(response=>{if(response.status!==200){return false}return response.text()}).then(data=>{if(data){var parser=new DOMParser;var result=parser.parseFromString(data,"text/html");let preMaterial=result.getElementById("material");preMaterial.querySelectorAll(".is-invalid").forEach(el=>{el.classList.remove("is-invalid")});preMaterial.querySelectorAll(".invalid-feedback").forEach(el=>{el.remove()});preMaterial?document.getElementById("material").replaceWith(preMaterial):preMaterial.innerHTML="";let replacer=document.getElementById(forms.name+"_material");replacer&&replacer.type!=="hidden"?preMaterial.classList.remove("d-none"):null;if(replacer){if(replacer.tagName==="SELECT"){new NiceSelect(replacer,{searchable:true});let focus=document.getElementById(forms.name+"_material_select2");focus?focus.click():null}}let preOffer=document.getElementById("offer");preOffer?preOffer.innerHTML="":null;preOffer?preOffer.classList.add("d-none"):null;let preVariation=document.getElementById("variation");preVariation?preVariation.innerHTML="":null;preVariation?preVariation.classList.add("d-none"):null;let preModification=document.getElementById("modification");preModification?preModification.innerHTML="":null;preModification?preModification.classList.add("d-none"):null;if(replacer){replacer.addEventListener("change",function(event){changeObjectMaterial(forms);return false})}}enableElementsForm(forms)})}async function changeObjectMaterial(forms){disabledElementsForm(forms);document.getElementById("offer").classList.add("d-none");document.getElementById("variation").classList.add("d-none");document.getElementById("modification").classList.add("d-none");const data=new FormData(forms);const formData=new FormData;formData.append(forms.name+"[material]",data.get(forms.name+"[material]"));await fetch(forms.action,{method:forms.method,cache:"no-cache",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"},redirect:"follow",referrerPolicy:"no-referrer",body:formData}).then(response=>{if(response.status!==200){return false}return response.text()}).then(data=>{if(data){var parser=new DOMParser;var result=parser.parseFromString(data,"text/html");let preOffer=result.getElementById("offer");preOffer?document.getElementById("offer").replaceWith(preOffer):preOffer.innerHTML="";if(preOffer){let replaceOfferId=forms.name+"_offer";let replacer=document.getElementById(replaceOfferId);replacer&&replacer.type!=="hidden"?preOffer.classList.remove("d-none"):null;if(replacer.tagName==="SELECT"){new NiceSelect(replacer,{searchable:true});let focus=document.getElementById(forms.name+"_offer_select2");focus?focus.click():null}}let preVariation=document.getElementById("variation");preVariation?preVariation.innerHTML="":null;preVariation?preVariation.classList.add("d-none"):null;let preModification=document.getElementById("modification");preModification?preModification.innerHTML="":null;preModification?preModification.classList.add("d-none"):null;let offerChange=document.getElementById(forms.name+"_offer");if(offerChange){offerChange.addEventListener("change",function(event){changeObjectOffer(forms);return false})}}enableElementsForm(forms)})}async function changeObjectOffer(forms){disabledElementsForm(forms);document.getElementById("variation").classList.add("d-none");document.getElementById("modification").classList.add("d-none");const data=new FormData(forms);const formData=new FormData;formData.append(forms.name+"[offer]",data.get(forms.name+"[offer]"));await fetch(forms.action,{method:forms.method,cache:"no-cache",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"},redirect:"follow",referrerPolicy:"no-referrer",body:formData}).then(response=>{if(response.status!==200){return false}return response.text()}).then(data=>{if(data){var parser=new DOMParser;var result=parser.parseFromString(data,"text/html");let preVariation=result.getElementById("variation");if(preVariation){document.getElementById("variation").replaceWith(preVariation);let replacer=document.getElementById(forms.name+"_variation");replacer&&replacer.type!=="hidden"?preVariation.classList.remove("d-none"):null;if(replacer){if(replacer.tagName==="SELECT"){new NiceSelect(replacer,{searchable:true});let focus=document.getElementById(forms.name+"_variation_select2");focus?focus.click():null;replacer.addEventListener("change",function(event){changeObjectVariation(forms);return false})}}}let preModification=document.getElementById("modification");preModification?preModification.innerHTML="":null;preModification?preModification.classList.add("d-none"):null}enableElementsForm(forms)})}async function changeObjectVariation(forms){disabledElementsForm(forms);document.getElementById("modification").classList.add("d-none");const data=new FormData(forms);const formData=new FormData;formData.append(forms.name+"[variation]",data.get(forms.name+"[variation]"));await fetch(forms.action,{method:forms.method,cache:"no-cache",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"},redirect:"follow",referrerPolicy:"no-referrer",body:formData}).then(response=>{if(response.status!==200){return false}return response.text()}).then(data=>{if(data){var parser=new DOMParser;var result=parser.parseFromString(data,"text/html");let preModification=result.getElementById("modification");if(preModification){document.getElementById("modification").replaceWith(preModification);let replacer=document.getElementById(forms.name+"_modification");replacer&&replacer.type!=="hidden"?preModification.classList.remove("d-none"):null;console.log(replacer&&replacer.type!=="hidden");if(replacer){if(replacer.tagName==="SELECT"){new NiceSelect(replacer,{searchable:true});let focus=document.getElementById(forms.name+"_modification_select2");focus?focus.click():null}}}}enableElementsForm(forms)})}